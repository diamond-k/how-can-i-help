﻿
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
	<title>Contact Me</title>
	<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="IE=9;IE=10;IE=11,IE=Edge,chrome=1" />

	<meta name="description" content="contact form">
	<meta name="keywords" content="contact form, help, how can i help you, help you">


	<link rel="icon" type="image/png" href="images/favicon-32x32.png" sizes="32x32" />

	<link rel="icon" type="image/png" href="images/favicon-16x16.png" sizes="16x16" />



	<link rel="stylesheet" href="css/site.css"  type="text/css"/>
	<link rel="stylesheet" href="css/site.min.css" asp-append-version="true" type="text/css" />
	<link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.7/css/bootstrap.min.css"
		  asp-fallback-href="lib/bootstrap/dist/css/bootstrap.min.css"
		  asp-fallback-test-class="sr-only" asp-fallback-test-property="position" asp-fallback-test-value="absolute" />

	<style type="text/css">

			/** Keyframes ***/
	@-ms-keyframes bounceInDown {
		0% {
			opacity: 0;
			-ms-transform: translateY(-2000px);
		}

		60% {
			opacity: 1;
			-ms-transform: translateY(30px);
		}

		80% {
			-ms-transform: translateY(-10px);
		}

		100% {
			-ms-transform: translateY(0);
		}
	}


	@-moz-keyframes bounceInDown {
		0% {
			opacity: 0;
			-moz-transform: translateY(-2000px);
		}

		60% {
			opacity: 1;
			-moz-transform: translateY(30px);
		}

		80% {
			-moz-transform: translateY(-10px);
		}

		100% {
			-moz-transform: translateY(0);
		}
	}


	@keyframes bounceInDown {
		0% {
			opacity: 0;
			transform: translateY(-2000px);
		}

		60% {
			opacity: 1;
			transform: translateY(30px);
		}

		80% {
			transform: translateY(-10px);
		}

		100% {
			transform: translateY(0);
		}
	}

	@-webkit-keyframes bounceInDown {
		0% {
			opacity: 0;
			-webkit-transform: translateY(-2000px);
		}

		60% {
			opacity: 1;
			-webkit-transform: translateY(30px);
		}

		80% {
			-webkit-transform: translateY(-10px);
		}

		100% {
			-webkit-transform: translateY(0);
		}
	}


	#email-invalid {
		font-size: 12px;
		line-height: 1.91667;
		font-weight: 400;
		color: #d62c0b;
		display: -webkit-box;
		display: -ms-flexbox;
		display: flex;
		-ms-flex-wrap: wrap;
		flex-wrap: wrap;
		min-width: 0;
		-webkit-box-flex: 0;
		-ms-flex: 0 0 100%;
		flex: 0 0 100%;
		max-width: 100%;
		padding-top: 0px;
		margin-left: 11px;
	}

	body {
		margin: 2em;
		background: #222222 url('images/marion-michele-191320.jpg') no-repeat top center fixed;
		background-size: cover;
		color: #b5b5b5;
		font-family: sans-serif;
		opacity: 0.93;
	}

	#appView {
		overflow: hidden;
		background: #FFFFFF;
		-moz-animation-fill-mode: both;
		-moz-animation-duration: 1.5s;
		-moz-animation-name: bounceInDown;
		-webkit-appearance: none;
		-webkit-animation-fill-mode: both;
		-webkit-animation-duration: 1.5s;
		-webkit-animation-name: bounceInDown;
		animation-fill-mode: both;
		animation-duration: 1.5s;
		animation-name: bounceInDown;
		box-shadow: 0 0 0 9999px rgba(0,0,0,0.3);
		-webkit-box-shadow: 0 0 0 9999px rgba(0,0,0,0.3);
	border-radius: 1px;
	}

	/*desktops, big landscape tablets and laptops(Large, Extra large)####*/
	@media screen and (min-width: 1024px) {
		#appView {
			width: 400px;
			position: absolute;
			top: 50%;
			left: 50%;
			margin: -255px 0 0 -200px;
			background: #FFFFFF;
			box-shadow: 0 0 0 9999px rgba(0,0,0,0.3);
			-webkit-box-shadow: 0 0 0 9999px rgba(0,0,0,0.3);
			-moz-animation-fill-mode: both;
			-moz-animation-duration: 1.5s;
			-moz-animation-name: bounceInDown;
			-webkit-animation-fill-mode: both;
			-webkit-animation-duration: 1.5s;
			-webkit-animation-name: bounceInDown;
			animation-fill-mode: both;
			animation-duration: 1.5s;
			animation-name: bounceInDown;
			border-radius: 3px;
		}
	}

	/*Tablet(medium)*/
	@media screen and (min-width : 768px) and (max-width : 1023px) {
		#appView {
			width: 400px;
			position: absolute;
			top: 50%;
			left: 50%;
			margin: -255px 0 0 -200px;
			background: #FFFFFF;
			box-shadow: 0 0 0 9999px rgba(0,0,0,0.3);
			-webkit-box-shadow: 0 0 0 9999px rgba(0,0,0,0.3);
			-moz-animation-fill-mode: both;
			-moz-animation-duration: 1.5s;
			-moz-animation-name: bounceInDown;
			-webkit-animation-fill-mode: both;
			-webkit-animation-duration: 1.5s;
			-webkit-animation-name: bounceInDown;
			animation-fill-mode: both;
			animation-duration: 1.5s;
			animation-name: bounceInDown;
			border-radius: 3px;
		}
	}


	.col-md-4 {
		position: relative;
		min-height: 1px;
		padding-right: 0;
		padding-left: 0;
	}

	p {
		font-size: 16px;
	}

	.intouch {
		/*#3299bb;#3E3E3E;*/
		color: #a4bc4f;
	}

	/*h1, h2, h3, h5, h6 {

				font-family: Impact, fantasy;

			}*/

	h4 {
		/*font-family: Impact, fantasy;*/
		color: #b5b5b5; /*#3299bb;rgb(132, 142, 156)*/
		font-size: 20px;
		font-weight: bold;
		padding-left: 5px;
		padding-right: 5px;
	}


	h2 {
		color: #a4bc4f;
		font-size: 26px;
		font-weight: 400;
		text-align: left;
		/* padding: 20px 5px 0 5px;*/
		padding: 20px 5px 10px 5px;
	}

	/*.content-head {
		<!--  text-transform: uppercase;-->
		  letter-spacing: 0.1em;
		  margin: 1em 0 1em;
		}*/



	.is-center {
		text-align: center;
	}


	.wrapper {
		text-align: center;
		margin-top: 0px;
		margin-bottom: 10px;
	}


	#firstname:active, #firstname:focus,
	#lastname:active, #lastname:focus,
	#message:active, #message:focus,
	#email:focus, #email:active {
		background: #F0F0F0;
		border: 1px solid #ccc;
	}

	input[type="text"] {
		width: 290px;
		padding: 20px 0;
		background: transparent;
		color: #222;
		margin: 0 auto;
		/*text-indent: 20px;*/
		font-weight: normal;
		/*box-shadow: none;*/
	}


	input[type="text"] {
		/*border-left: 5px solid transparent;*/
		transition: all 0.3s linear;
	}

	#submitbtn {
		margin: 0px;
		background: #b5cd60;
		border: 0;
		border-radius: 3px;
		color: white;
		font-weight: bold;
		cursor: pointer;
		transition: background 0.3s ease-in-out;
		color: white;
		float: none;
		width: 95%;
		padding: 10px;
		text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
		/*background-color: #60AA14;*/
	}

		#submitbtn:hover {
			background: #a4bc4f;
		}

	.button-xlarge {
		font-size: 125%;
	}


	#lastname, #firstname {
		margin: 0 auto 10px auto;
		width: 95%;
	}

	#email {
		width: 95%;
		padding: 10px;
		margin-top: 0;
		margin-right: auto;
		margin-bottom: 10px;
		margin-left: auto;
		border-radius: 4px;
		/* top: -1px;*/
		font-weight: normal;
		color: #222;
	}


	#message {
		margin-top: 0;
		margin-right: auto;
		margin-bottom: 10px;
		margin-left: auto;
		min-height: 150px;
		max-height: 150px;
		width: 95%;
		max-width: 95%;
		min-width: 95%;
		color: #222;
		background: transparent;
		font-weight: normal;
	}

	input, select, textarea {
		max-width: none;
	}

	::-webkit-input-placeholder { /* Chrome/Opera/Safari */
		color: #777;
		font-weight: normal;
	}

	::-moz-placeholder { /* Firefox 19+ */
		color: #777;
		font-weight: normal;
	}

	:-ms-input-placeholder { /* IE 10+ */
		color: #777;
		font-weight: normal;
	}

	:-moz-placeholder { /* Firefox 18- */
		color: #777;
		font-weight: normal;
	}

	</style>

</head>
<body>



				<div class="container body-content">
		

		<div id="appView" class="col-md-4 col-md-offset-4">

			<h2 id="intouch" class="content-head is-center intouch"> Are you ready to receive great products and services?</h2>
			<h4 id="intouch1" class="content-head is-center">Send me a message!</h4>


			<!--   <link rel="stylesheet" href="https://cdn.rawgit.com/dwyl/html-form-send-email-via-google-script-without-server/master/style.css">-->

			<form id="myForm" novalidate="novalidate" method="POST" class="pure-form pure-form-stacked" action="https://script.google.com/macros/s/AKfycbwskzHS-WHdpKfXDU5_ctpYZwk7M8ysI6eAhacIRGTAdkksxBk/exec">
				<div class="pure-group">
					<!-- <label id="namelbl" for="name">Name: </label>-->
					<input type="text" class="border" id="firstname" name="firstname" placeholder="First name" />
				</div>
				<div class="pure-group">
					<!-- <label id="namelbl" for="name">Name: </label>-->
					<input class="border" type="text" id="lastname" name="lastname" placeholder="Last name" />
				</div>

				<div class="pure-group">
					<!-- <label id="messagelbl" for="message">Message: </label>-->
					<textarea class="border" type="text" id="message" name="message" rows="10" cols="50" placeholder="What services would you require?"></textarea>
				</div>

				<div class="pure-group">
					<!--<label id="emaillbl" for="email"><i>Your</i> Email Address:</label>-->
					<input class="border" id="email" name="email" type="email" required="true" placeholder="Email" />
					<span id="email-invalid" style="display:none">
						Please enter a valid email address
					</span>
				</div>

				<div class="wrapper">
					<button type="submit" id="submitbtn" class="button-success pure-button button-xlarge">
						<span class="fa fa-paper-plane"></span>&nbsp;Send
					</button>
				</div>
			</form>
		</div>

		<!-- Thankyou Message On form submit -->
		<!--<div style="display:none;" id="thankyou_message">
		<h1 class="heading-1">Thanks!</h1>
		<div class="text">
			<p>I’ve got your message and will be in touch soon.</p>
		</div>
	</div>-->
		<!--    <div style="text-align:center" class="pos">&copy; Contact Me <script>document.write(new Date().getFullYear())</script></div>-->
		<!-- Submit the Form using "AJAX" -->
<script data-cfasync="false" type="text/javascript">
	  $(document).ready(function(){  
	    
    $('#email').bind('input propertychange', function() {
            if( !validEmail($(this).val()) ) {   // if email is not valid show error
                document.getElementById('email-invalid').style.display = 'block';}
        else {
            document.getElementById('email-invalid').style.display = 'none';}
    });
        $("#myForm").submit(function(e){
          var result =  handleFormSubmit(e);
            if(result !== false){
                var btn = document.getElementById("submitbtn");
                    btn.innerHTML = "<i class='fa fa-paper-plane'></i>&nbsp;Sending...";
                //window.location.href = "http://edyson.acnshop.eu/default.asp?CO_LA=GB_en";
                window.location.replace("http://edyson.acnshop.eu/default.asp?CO_LA=GB_en");
            }
        });
    });
   function validEmail(email) {
          var re = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;
          return re.test(email);
    }
// get all data in form and return object
function getFormData() {
  var form = document.getElementById("myForm");
  var elements = form.elements; // all form elements
  var fields = Object.keys(elements).map(function(k) {
    if(elements[k].name !== undefined) {
      return elements[k].name;
    // special case for Edge's html collection
    }else if(elements[k].length > 0){
      return elements[k].item(0).name;
    }
  }).filter(function(item, pos, self) {
    return self.indexOf(item) == pos && item;
  });
  var data = {};
  fields.forEach(function(k){
    data[k] = elements[k].value;
    var str = ""; // declare empty string outside of loop to allow
                  // it to be appended to for each item in the loop
    if(elements[k].type === "checkbox"){ // special case for Edge's html collection
      str = str + elements[k].checked + ", "; // take the string and append
                                              // the current checked value to
                                              // the end of it, along with
                                   // a comma and a space
      data[k] = str.slice(0, -2); // remove the last comma and space
                                  // from the  string to make the output
                                  // prettier in the spreadsheet
    }else if(elements[k].length){
      for(var i = 0; i < elements[k].length; i++){
        if(elements[k].item(i).checked){
          str = str + elements[k].item(i).value + ", "; // same as above
          data[k] = str.slice(0, -2);
        }
      }
    }
  });
  // add form-specific values into the data
  data.formDataNameOrder = JSON.stringify(fields);
  data.formGoogleSheetName = form.dataset.sheet || "responses"; // default sheet name
  data.formGoogleSendEmail = form.dataset.email || ""; // no email by default
  console.log(data);
  return data;
}
function handleFormSubmit(event) {  // handles form submit
  event.preventDefault();           // submitting via xhr below
  var data = getFormData();         // get the values submitted in the form
  if( !validEmail(data.email) ) {   // if email is not valid show error
    document.getElementById('email-invalid').style.display = 'block';
    return false;
  } else {
    document.getElementById('email-invalid').style.display = 'none';
    var url = event.target.action;
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url);
   // xhr.withCredentials = true;
   xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.onreadystatechange = function() {
       console.log( xhr.status, xhr.statusText )
       console.log(xhr.responseText);
     return;
    };
    // url encode form data for sending as post data
    var encoded = Object.keys(data).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(data[k])
    }).join('&')
    xhr.send(encoded);
  }
}
		</script>

	</div>



</body>
</html>

